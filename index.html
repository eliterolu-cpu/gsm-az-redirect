<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>GsmAZ - Neon Grid AI</title>
  
  <link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap' rel='stylesheet'/>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css' rel='stylesheet'/>
  <script src='https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js'></script>

  <style>
    :root {
      --neon-pink: #ff00ff;
      --neon-cyan: #00ffff;
      --neon-purple: #9d00ff;
      --glass: rgba(15, 10, 40, 0.7);
      --text: #e0f0ff;
      --bg-dark: #0a001a;
      --success: #00ff9d;
      --error: #ff3366;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body { background: var(--bg-dark); color: var(--text); font-family: 'Inter', 'Segoe UI', sans-serif; font-size: 15px; line-height: 1.5; min-height: 100vh; position: relative; overflow-x: hidden; }

    body::before {
      content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: repeating-linear-gradient(0deg, transparent, transparent 40px, rgba(0,255,255,0.05) 40px, rgba(0,255,255,0.05) 42px),
                  repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(255,0,255,0.05) 40px, rgba(255,0,255,0.05) 42px);
      pointer-events: none; z-index: 1;
    }

    #particles-js { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }

    .site-header { background: rgba(10, 0, 30, 0.8); backdrop-filter: blur(10px); border-bottom: 1px solid var(--neon-cyan); position: fixed; width: 100%; top: 0; z-index: 1000; }
    .header-container { max-width: 1200px; margin: 0 auto; padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; }
    .logo { font-size: 24px; font-weight: 700; color: var(--neon-cyan); text-decoration: none; text-shadow: 0 0 15px var(--neon-cyan); }
    .header-right { display: flex; align-items: center; gap: 20px; }
    .auth-btn, .logout-btn { background: transparent; border: 2px solid var(--neon-cyan); color: var(--neon-cyan); padding: 8px 20px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.4s; }
    .auth-btn:hover, .logout-btn:hover { background: var(--neon-cyan); color: #000; box-shadow: 0 0 30px rgba(0,255,255,0.8); }
    .user-greeting { color: var(--neon-cyan); font-size: 14px; text-shadow: 0 0 10px var(--neon-cyan); }

    .page { display: none; }
    .page.active { display: block; }

    .main-content { max-width: 1100px; margin: 90px auto 40px; padding: 0 20px; position: relative; z-index: 3; text-align: center; }
    h1 { font-size: 3rem; text-shadow: 0 0 30px var(--neon-pink); margin: 60px 0 20px; }
    .tagline { font-size: 1.4rem; opacity: 0.9; margin-bottom: 50px; }

    .auth-container { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(0,255,255,0.3); border-radius: 20px; padding: 40px; max-width: 500px; margin: 40px auto; box-shadow: 0 0 60px rgba(0,255,255,0.3); }
    .auth-form h2 { font-size: 2rem; color: var(--neon-cyan); margin-bottom: 30px; }
    .message { padding: 12px; border-radius: 10px; margin: 15px 0; font-size: 14px; text-align: center; }
    .message.success { background: rgba(0,255,157,0.2); border: 1px solid var(--success); color: var(--success); }
    .message.error { background: rgba(255,51,102,0.2); border: 1px solid var(--error); color: var(--error); }
    .form-group { margin-bottom: 20px; text-align: left; }
    label { display: block; margin-bottom: 8px; color: var(--neon-cyan); }
    input { width: 100%; padding: 14px; background: rgba(0,0,0,0.4); border: 2px solid var(--neon-purple); border-radius: 10px; color: var(--text); font-size: 15px; }
    input:focus { outline: none; border-color: var(--neon-cyan); box-shadow: 0 0 20px rgba(0,255,255,0.4); }
    .submit-btn { background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink)); color: #000; border: none; padding: 16px; width: 100%; border-radius: 30px; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 20px; transition: 0.4s; }
    .submit-btn:hover { box-shadow: 0 0 40px rgba(255,0,255,0.9); transform: scale(1.03); }
    .switch-link { margin-top: 20px; color: var(--neon-cyan); cursor: pointer; font-size: 14px; }
    .switch-link span { color: var(--neon-pink); text-decoration: underline; }

    .services-section { margin: 80px 0; }
    .services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; margin-top: 40px; }
    .service-card { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(0,255,255,0.3); border-radius: 20px; padding: 30px; transition: 0.4s; }
    .service-card:hover { transform: translateY(-10px); box-shadow: 0 0 50px rgba(255,0,255,0.4); }
    .service-card h3 { font-size: 1.6rem; color: var(--neon-pink); margin-bottom: 15px; }
    .free-badge { background: var(--neon-cyan); color: #000; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; display: inline-block; margin-bottom: 15px; }

    .credit-balance { background: rgba(0,255,255,0.1); border: 1px solid var(--neon-cyan); padding: 8px 14px; border-radius: 30px; font-size: 14px; color: var(--neon-cyan); text-shadow: 0 0 10px var(--neon-cyan); }
    .credit-balance strong { color: var(--neon-pink); font-size: 16px; }
    .cart-icon-container { position: relative; cursor: pointer; padding: 12px; border-radius: 50%; transition: background 0.3s; }
    .cart-icon-container:hover { background: rgba(0,255,255,0.1); }
    .cart-icon { color: var(--neon-cyan); font-size: 28px; text-shadow: 0 0 15px var(--neon-cyan); }
    .cart-count { background: var(--neon-pink); box-shadow: 0 0 15px var(--neon-pink); font-size: 12px; width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; position: absolute; top: -6px; right: -6px; font-weight: bold; }
    .credits-section { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(0,255,255,0.3); border-radius: 20px; padding: 20px; margin: 40px 0; text-align: center; }
    .credit-packages { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin: 15px 0; }
    .credit-package { background: rgba(0,0,0,0.4); border: 2px solid var(--neon-purple); border-radius: 15px; padding: 18px; transition: 0.4s; }
    .credit-package:hover { border-color: var(--neon-cyan); transform: scale(1.05); box-shadow: 0 0 30px rgba(0,255,255,0.4); }
    .buy-credit-btn { background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink)); color: #000; border: none; padding: 12px 20px; border-radius: 30px; font-weight: bold; cursor: pointer; width: 100%; font-size: 15px; transition: 0.4s; }
    .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 30px; }
    .product-card { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(0,255,255,0.3); border-radius: 20px; overflow: hidden; transition: all 0.4s ease; box-shadow: 0 8px 30px rgba(0,0,0,0.6); }
    .product-card:hover { transform: translateY(-15px) scale(1.05); border-color: var(--neon-pink); box-shadow: 0 25px 60px rgba(255,0,255,0.4); }
    .product-image { width: 100%; height: 220px; object-fit: cover; }
    .product-info { padding: 25px; text-align: center; }
    .product-title { font-size: 19px; margin-bottom: 12px; color: var(--neon-cyan); }
    .product-price { font-size: 24px; font-weight: bold; color: var(--neon-pink); margin-bottom: 20px; }
    .add-to-cart-btn { background: transparent; border: 3px solid var(--neon-cyan); color: var(--neon-cyan); padding: 16px 40px; border-radius: 50px; font-weight: bold; font-size: 16px; transition: all 0.4s; cursor: pointer; min-width: 180px; text-transform: uppercase; letter-spacing: 1px; }
    .add-to-cart-btn:hover { background: var(--neon-cyan); color: #000; box-shadow: 0 0 40px rgba(0,255,255,0.9); transform: scale(1.05); }
    .cart-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1999; opacity: 0; visibility: hidden; transition: all 0.4s ease; }
    .cart-overlay.active { opacity: 1; visibility: visible; }
    .cart-sidebar { position: fixed; top: 0; right: -300px; width: 300px; height: 100vh; background: rgba(10, 0, 30, 0.95); backdrop-filter: blur(20px); border-left: 2px solid var(--neon-purple); box-shadow: -8px 0 40px rgba(157,0,255,0.5); transition: right 0.4s ease; z-index: 2000; display: flex; flex-direction: column; }
    .cart-sidebar.active { right: 0; }
    .cart-header { padding: 12px; border-bottom: 1px solid rgba(0,255,255,0.3); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
    .close-cart { background: none; border: none; color: var(--neon-cyan); font-size: 22px; cursor: pointer; padding: 5px; }
    .cart-items { flex: 1; overflow-y: auto; padding: 8px; }
    .cart-item { display: flex; align-items: center; background: rgba(0,0,0,0.4); border-radius: 8px; padding: 8px; margin-bottom: 8px; border: 1px solid rgba(0,255,255,0.2); }
    .cart-item-image { width: 45px; height: 45px; object-fit: cover; border-radius: 6px; margin-right: 8px; }
    .quantity-btn { background: rgba(0,255,255,0.2); border: 2px solid var(--neon-cyan); color: var(--neon-cyan); width: 28px; height: 28px; border-radius: 50%; font-size: 14px; font-weight: bold; cursor: pointer; transition: 0.3s; }
    .quantity-btn:hover { background: var(--neon-cyan); color: #000; transform: scale(1.1); }
    .checkout-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 3000; padding: 15px; }
    .checkout-modal.active { display: flex; }
    .checkout-box { background: var(--glass); backdrop-filter: blur(20px); border: 1px solid var(--neon-cyan); border-radius: 18px; padding: 18px; width: 100%; max-width: 450px; max-height: 90vh; overflow-y: auto; box-shadow: 0 0 60px rgba(0,255,255,0.5); }
    .confirm-btn { background: linear-gradient(45deg, var(--neon-cyan), var(--neon-pink)); color: #000; border: none; padding: 14px; width: 100%; border-radius: 35px; font-weight: bold; cursor: pointer; }
    .notification { position: fixed; top: 90px; right: 15px; background: rgba(20,0,40,0.95); padding: 15px; border-radius: 10px; border-left: 4px solid var(--neon-pink); box-shadow: 0 0 35px rgba(0,255,255,0.4); z-index: 4000; min-width: 240px; font-size: 13px; }
  </style>
</head>

<body>
  <div id="particles-js"></div>

  <!-- Landing Page -->
  <div class="page active" id="landingPage">
    <header class="site-header">
      <div class="header-container">
        <a class="logo" href="#">ðŸ›¸ GsmAZ</a>
        <div class="header-right">
          <button class="auth-btn" id="loginBtn">Login</button>
          <button class="auth-btn" id="signupBtn">Sign Up</button>
        </div>
      </div>
    </header>

    <main class="main-content">
      <h1>Welcome to Neon Grid AI</h1>
      <p class="tagline">Unlock the power of advanced AI in a cyberpunk universe.</p>

      <div class="auth-container">
        <div class="auth-form" id="loginForm">
          <h2>Login</h2>
          <div id="loginMessage"></div>
          <form id="loginSubmit">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="loginEmail" placeholder="you@gsm.az" required/>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input type="password" id="loginPass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required/>
            </div>
            <button type="submit" class="submit-btn">Login</button>
            <p class="switch-link"><span id="toForgot">Forgot Password?</span></p>
            <p class="switch-link" id="toSignup">New here? <span>Sign Up</span></p>
          </form>
        </div>

        <div class="auth-form" id="signupForm" style="display:none;">
          <h2>Sign Up</h2>
          <div id="signupMessage"></div>
          <form id="signupSubmit">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="signupEmail" placeholder="you@gsm.az" required/>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input type="password" id="signupPass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢ (min 6 chars)" required/>
            </div>
            <button type="submit" class="submit-btn">Create Account</button>
            <p class="switch-link" id="toLogin">Already have an account? <span>Login</span></p>
          </form>
        </div>

        <div class="auth-form" id="recoveryForm" style="display:none;">
          <h2>Recover Password</h2>
          <div id="recoveryMessage"></div>
          <form id="recoverySubmit">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="recoveryEmail" placeholder="you@gsm.az" required/>
            </div>
            <button type="submit" class="submit-btn">Send Reset Link</button>
            <p class="switch-link" id="backToLogin"><span>Back to Login</span></p>
          </form>
        </div>
      </div>

      <div class="services-section">
        <h2>Our AI Services</h2>
        <div class="services-grid">
          <div class="service-card"><span class="free-badge">Free Tier</span><h3>Text Generation</h3><p>Stories, code, chat.</p></div>
          <div class="service-card"><span class="free-badge">Free Tier</span><h3>Image Generation</h3><p>Cyberpunk art from text.</p></div>
          <div class="service-card"><h3>Code Assistant</h3><p>Debug and optimize code.</p></div>
          <div class="service-card"><h3>Voice Synthesis</h3><p>Natural speech.</p></div>
          <div class="service-card"><span class="free-badge">Free</span><h3>Basic Chatbot</h3><p>Quick answers.</p></div>
          <div class="service-card"><h3>Advanced Analytics</h3><p>Data insights.</p></div>
        </div>
      </div>
    </main>
  </div>

  <!-- Store Page -->
  <div class="page" id="storePage">
    <header class="site-header">
      <div class="header-container">
        <a class="logo" href="#">ðŸ›¸ GsmAZ</a>
        <div class="header-right">
          <div class="user-greeting" id="userGreeting">Hello!</div>
          <div class="credit-balance" id="creditBalance">Credits: <strong>0</strong></div>
          <div class="cart-icon-container" id="openCart">
            <i class="fas fa-shopping-cart cart-icon"></i>
            <span class="cart-count" id="cartCount">0</span>
          </div>
          <button class="logout-btn" id="logoutBtn">Logout</button>
        </div>
      </div>
    </header>

    <main class="main-content" style="padding-top: 100px;">
      <h1>Welcome to the Grid â€” GsmAZ</h1>
      <p style="text-align:center; font-size:1.2rem; opacity:0.9; margin-bottom:40px;">Pay with Credits or USDT.</p>

      <div class="credits-section">
        <h2>Buy Credits</h2>
        <div class="credit-packages">
          <div class="credit-package"><h3>$10 = 100 Credits</h3><button class="buy-credit-btn" onclick="buyCredits(10,100)">Buy with USDT</button></div>
          <div class="credit-package"><h3>$25 = 275 Credits</h3><p>(+10% bonus)</p><button class="buy-credit-btn" onclick="buyCredits(25,275)">Buy with USDT</button></div>
          <div class="credit-package"><h3>$50 = 550 Credits</h3><p>(+10% bonus)</p><button class="buy-credit-btn" onclick="buyCredits(50,550)">Buy with USDT</button></div>
        </div>
      </div>

      <div class="products-grid" id="products"></div>
    </main>

    <!-- Cart, Checkout, Receipt, Notification (same as original) -->
    <div class="cart-overlay" id="cartOverlay"></div>
    <div class="cart-sidebar" id="cartSidebar">
      <div class="cart-header">
        <h3>Your Cart</h3>
        <button class="close-cart" id="closeCart"><i class="fas fa-times"></i></button>
      </div>
      <div class="cart-items" id="cartItems">
        <div class="cart-empty" id="cartEmpty">Your cart is empty</div>
      </div>
      <div class="cart-footer">
        <div class="cart-total">
          <span>Total:</span>
          <span id="cartTotalPrice">$0.00</span>
        </div>
        <button class="checkout-btn" id="checkoutBtn">Proceed to Checkout</button>
      </div>
    </div>

    <div class="checkout-modal" id="checkoutModal">
      <!-- Full checkout modal markup from your original -->
    </div>

    <div class="receipt-modal" id="receiptModal">
      <!-- Full receipt modal markup from your original -->
    </div>

    <div class="notification-container" id="notificationContainer"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAl9uDtI1t3Hrp_Yh9LT4aFuT2vPcTH3nY",
      authDomain: "gsmaz-8f096.firebaseapp.com",
      projectId: "gsmaz-8f096",
      storageBucket: "gsmaz-8f096.firebasestorage.app",
      messagingSenderId: "579337455988",
      appId: "1:579337455988:web:40415e6cb4ffce0ffb0421"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    function showMessage(id, text, type = 'success') {
      const container = document.getElementById(id);
      container.innerHTML = `<div class="message ${type}">${text}</div>`;
      setTimeout(() => container.innerHTML = '', 6000);
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        document.getElementById('landingPage').classList.remove('active');
        document.getElementById('storePage').classList.add('active');
        const username = user.email.split('@')[0];
        document.getElementById('userGreeting').textContent = `Hello, ${username}!`;
        initStore();
      } else {
        document.getElementById('storePage').classList.remove('active');
        document.getElementById('landingPage').classList.add('active');
      }
    });

    document.getElementById('loginSubmit').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPass').value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
        showMessage('loginMessage', 'Welcome back!', 'success');
      } catch (error) {
        showMessage('loginMessage', error.message, 'error');
      }
    };

    document.getElementById('signupSubmit').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPass').value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        showMessage('signupMessage', 'Account created! Logging in...', 'success');
      } catch (error) {
        showMessage('signupMessage', error.message, 'error');
      }
    };

    document.getElementById('recoverySubmit').onsubmit = async (e) => {
      e.preventDefault();
      const email = document.getElementById('recoveryEmail').value.trim();
      try {
        await sendPasswordResetEmail(auth, email);
        showMessage('recoveryMessage', 'Reset link sent!', 'success');
      } catch (error) {
        showMessage('recoveryMessage', error.message, 'error');
      }
    };

    document.getElementById('logoutBtn').onclick = async () => {
      await signOut(auth);
    };

    // Form switching
    document.getElementById('toSignup').onclick = () => { document.getElementById('loginForm').style.display = 'none'; document.getElementById('signupForm').style.display = 'block'; };
    document.getElementById('toLogin').onclick = () => { document.getElementById('signupForm').style.display = 'none'; document.getElementById('loginForm').style.display = 'block'; };
    document.getElementById('toForgot').onclick = () => { document.getElementById('loginForm').style.display = 'none'; document.getElementById('recoveryForm').style.display = 'block'; };
    document.getElementById('backToLogin').onclick = () => { document.getElementById('recoveryForm').style.display = 'none'; document.getElementById('loginForm').style.display = 'block'; };
    document.getElementById('loginBtn').onclick = () => { document.getElementById('signupForm').style.display = 'none'; document.getElementById('recoveryForm').style.display = 'none'; document.getElementById('loginForm').style.display = 'block'; };
    document.getElementById('signupBtn').onclick = () => { document.getElementById('loginForm').style.display = 'none'; document.getElementById('recoveryForm').style.display = 'none'; document.getElementById('signupForm').style.display = 'block'; };

    particlesJS('particles-js', {
      "particles": { "number": { "value": 60 }, "color": { "value": ["#00ffff", "#ff00ff"] },
        "opacity": { "value": 0.6, "random": true }, "size": { "value": 3, "random": true },
        "line_linked": { "enable": true, "distance": 120, "color": "#00ffff", "opacity": 0.3, "width": 1 },
        "move": { "enable": true, "speed": 1.5 }
      },
      "interactivity": { "events": { "onhover": { "enable": true, "mode": "repulse" } } },
      "retina_detect": true
    });

    // === FULL STORE LOGIC ===
    const products = [
      { id: 1, name: "Premium Wireless Earbuds", price: 89.99, image: "https://images.unsplash.com/photo-1590658165737-15a047b8b5e3?w=400&h=300&fit=crop" },
      { id: 2, name: "Smart Watch Pro", price: 249.99, image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400&h=300&fit=crop" },
      { id: 3, name: "Laptop Backpack", price: 59.99, image: "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=400&h=300&fit=crop" },
      { id: 4, name: "Coffee Maker", price: 129.99, image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop" },
      { id: 5, name: "Fitness Tracker", price: 79.99, image: "https://images.unsplash.com/photo-1576243345690-4e4b79b63288?w=400&h=300&fit=crop" },
      { id: 6, name: "Bluetooth Speaker", price: 49.99, image: "https://images.unsplash.com/photo-1546435770-a3eeb64c6a62?w=400&h=300&fit=crop" },
      { id: 7, name: "Neon Gaming Mouse", price: 49.99, image: "https://images.unsplash.com/photo-1611179690028-3cd2e6f5d8e8?w=400&h=300&fit=crop" },
      { id: 8, name: "VR Headset Pro", price: 399.99, image: "https://images.unsplash.com/photo-1592478411977-2f5e4a4d8a0f?w=400&h=300&fit=crop" },
      { id: 9, name: "Cyberpunk Hoodie", price: 79.99, image: "https://images.unsplash.com/photo-1551028719-00167b16eac5?w=400&h=300&fit=crop" },
      { id: 10, name: "Wireless Charging Pad", price: 39.99, image: "https://images.unsplash.com/photo-1586816016218-4b4f9e9f4653?w=400&h=300&fit=crop" }
    ];

    let cart = [];
    const cartKey = 'gsm_az_cart';
    let credits = 0;
    const creditsKey = 'gsm_az_credits';
    let pendingCreditPurchase = { amount: 0, credits: 0 };
    let paymentMethod = 'credits';

    const wallets = {
      bep20: { address: '0x4385189a6e39ca249c154c6b4d380c0e9466443a', name: 'BEP20 (BSC)' },
      trc20: { address: 'TKCy9KNK7XrG3DYcQKYwDeJdnbKF5cnuWx', name: 'TRC20 (Tron)' }
    };

    let selectedNetwork = null;

    const el = {
      openCart: document.getElementById('openCart'),
      cartOverlay: document.getElementById('cartOverlay'),
      cartSidebar: document.getElementById('cartSidebar'),
      closeCart: document.getElementById('closeCart'),
      cartItems: document.getElementById('cartItems'),
      cartEmpty: document.getElementById('cartEmpty'),
      cartTotalPrice: document.getElementById('cartTotalPrice'),
      checkoutBtn: document.getElementById('checkoutBtn'),
      checkoutModal: document.getElementById('checkoutModal'),
      checkoutTotalPrice: document.getElementById('checkoutTotalPrice'),
      confirmPayment: document.getElementById('confirmPayment'),
      submitHash: document.getElementById('submitHash'),
      receiptModal: document.getElementById('receiptModal'),
      productsGrid: document.getElementById('products'),
      notificationContainer: document.getElementById('notificationContainer'),
      cartCount: document.getElementById('cartCount'),
      currentCredits: document.getElementById('currentCredits')
    };

    function showNotification(message, isError = false) {
      const div = document.createElement('div');
      div.className = 'notification' + (isError ? ' error' : '');
      div.innerHTML = `<strong>${isError ? 'Error' : 'Success'}</strong><br/>${message}`;
      el.notificationContainer.appendChild(div);
      setTimeout(() => div.remove(), 8000);
    }

    function loadCredits() {
      const saved = localStorage.getItem(creditsKey);
      if (saved) credits = parseInt(saved) || 0;
      updateCreditDisplay();
    }

    function addCredits(amount) {
      credits += amount;
      localStorage.setItem(creditsKey, credits);
      updateCreditDisplay();
      showNotification(`+${amount} credits added!`);
    }

    function updateCreditDisplay() {
      document.getElementById('creditBalance').innerHTML = 'Credits: <strong>' + credits + '</strong>';
      if (el.currentCredits) el.currentCredits.textContent = credits;
    }

    function loadCart() {
      const saved = localStorage.getItem(cartKey);
      if (saved) cart = JSON.parse(saved);
    }

    function saveCart() {
      localStorage.setItem(cartKey, JSON.stringify(cart));
    }

    function renderProducts() {
      el.productsGrid.innerHTML = products.map(p => `
        <div class="product-card">
          <img src="${p.image}" alt="${p.name}" class="product-image">
          <div class="product-info">
            <h3 class="product-title">${p.name}</h3>
            <div class="product-price">$${p.price.toFixed(2)}</div>
            <button class="add-to-cart-btn" onclick="addToCart(${p.id})">Add to Cart</button>
          </div>
        </div>
      `).join('');
    }

    function addToCart(id) {
      const product = products.find(p => p.id === id);
      const existing = cart.find(item => item.id === id);
      if (existing) {
        existing.quantity++;
      } else {
        cart.push({ ...product, quantity: 1 });
      }
      saveCart();
      updateCart();
      showNotification('Added to cart!');
    }

    function updateCart() {
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      el.cartCount.textContent = totalItems;

      if (cart.length === 0) {
        el.cartEmpty.style.display = 'block';
        el.cartItems.innerHTML = '';
        el.cartTotalPrice.textContent = '$0.00';
      } else {
        el.cartEmpty.style.display = 'none';
        let html = '';
        let total = 0;
        cart.forEach(item => {
          total += item.price * item.quantity;
          html += `
            <div class="cart-item">
              <img src="${item.image}" alt="${item.name}" class="cart-item-image">
              <div class="cart-item-details">
                <div class="cart-item-title">${item.name}</div>
                <div class="cart-item-price">$${item.price.toFixed(2)}</div>
              </div>
              <div class="cart-item-controls">
                <button class="quantity-btn" onclick="changeQuantity(${item.id}, -1)">-</button>
                <div class="quantity-display">${item.quantity}</div>
                <button class="quantity-btn" onclick="changeQuantity(${item.id}, 1)">+</button>
              </div>
            </div>
          `;
        });
        el.cartItems.innerHTML = html;
        el.cartTotalPrice.textContent = '$' + total.toFixed(2);
      }
    }

    function changeQuantity(id, delta) {
      const item = cart.find(item => item.id === id);
      if (item) {
        item.quantity += delta;
        if (item.quantity <= 0) cart = cart.filter(i => i.id !== id);
        saveCart();
        updateCart();
      }
    }

    function initStore() {
      loadCredits();
      loadCart();
      renderProducts();
      updateCart();

      el.openCart.onclick = () => {
        el.cartSidebar.classList.add('active');
        el.cartOverlay.classList.add('active');
      };

      el.closeCart.onclick = el.cartOverlay.onclick = () => {
        el.cartSidebar.classList.remove('active');
        el.cartOverlay.classList.remove('active');
      };

      el.checkoutBtn.onclick = () => {
        if (cart.length === 0) return showNotification('Cart is empty', true);
        // Open checkout modal (your original logic)
      };

      // Add your full checkout, buyCredits, etc. functions here
    }
  </script>
</body>
</html>
